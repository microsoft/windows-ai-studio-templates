# UX Config (WIP)

## General structure

In `sanitize.py`, the definition is `class ModelParameter(BaseModelClass)`.
We will take `vit-base-patch16-224_qdq_qnn.json.config` as example and generally it will be like this:

```Json
{
    "runtime": {
        // XXX
    },
    "sections": [
        {
            "name": "XXX",
            "phase": "XXX",
            "parameters": [
                // XXX
            ],
            "toggle": {
                // XXX
            }
        }
    ]
}
```

- runtime: It is a parameter and it is used to select target EP for evaluation
- sections: They are used for group parameters
    + phase: One of Conversion, Quantization, Evaluation
    + toggle: It is also a parameter to decide if this section is enabled or not

## Parameter

In `sanitize.py`, the definition is `class Parameter(BaseModel)`.
Parameter usually inherit from a template, for example:

```Json
{
    "name": "Activation Type",
    "tags": [
        "ActivationType"
    ],
    "type": "enum",
    // XXX
    "path": "passes.OnnxQuantization.activation_type",
    "values": [
        "int8",
        "uint8",
        "int16",
        "uint16"
    ],
    "template": {
        "path": "passes.OnnxQuantization.activation_type",
        "template": "ActivationType"
    }
}
```

In this parameter, all properties are copied from template `ActivationType` in `parameter_template.json` and only path is set by `template - path`

- tags: Used for special validations in UX
    + ActivationType / WeightType: display in the history
- type: Value type
    + enum: Choose from a limited set
    + bool: Choose from true / false
    + int: Integer
- path: Used to determine the status of the value by checking this path in the json

For enum and bool, we could also associate each choice with actions, for example:

```Json
"toggle": {
    "autoGenerated": true,
    "name": "Quantize model",
    "type": "bool",
    "path": "passes.OnnxQuantization",
    "actions": [
        [],
        [
            {
                "type": "update",
                "path": "passes",
                "value": {
                    "conversion": {
                        "type": "OnnxConversion",
                        "target_opset": 20,
                        "save_as_external_data": true
                    }
                }
            }
        ]
    ]
}
```

If `passes.OnnxQuantization` exists, it will be true.
If user chooses false, it will update passes with only conversion pass, so `passes.OnnxQuantization` will not exist.

Another example:

```Json
"toggle": {
    "autoGenerated": true,
    "name": "Evaluate model performance",
    "type": "bool",
    "path": "evaluator",
    "actions": [
        [],
        [
            {
                "type": "delete",
                "path": "evaluator"
            }
        ]
    ]
}
```
If `evaluator` exists, it will be true.
If user chooses false, it will delete evaluator, so `evaluator` will not exist.
